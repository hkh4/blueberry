%!PS
%%BeginProlog

%string or array concatenation
/concatenate { %given string1 and string2
   dup length 2 index length add 1 index type
   /arraytype eq {array}{string} ifelse
   dup 0 4 index putinterval
   dup 4 -1 roll length 4 -1 roll putinterval
} bind def

%%jpeg images
/printimage {
%% stack: xcoord, ycoord, scalex, scaley, sizex, sizey, pathtofile, color
   8 dict begin
   /color exch def
   /pathtofile exch def
   /sizey exch def
   /sizex exch def
   /scaley exch def
   /scalex exch def
   /ycoord exch def
   /xcoord exch def
   gsave
   xcoord ycoord translate
   scalex scaley scale
   sizex sizey
   8
   [sizex 0 0 -1 sizey mul 0 sizey]
   pathtofile (r) file /DCTDecode filter
   false
   color
   colorimage
   grestore
   end
} bind def

% Create one number of the time signature.
/timesignature { % stack: x-coord, y-coord, number
   5 dict begin
   /num exch def
   /ycoord exch def
   /xcoord exch def
   /str (images/Time_Signature/0.jpg) def
   /num2 {num 48 add} bind def
   str 22 num2 put
   xcoord ycoord 7 8.909 66 84 str 3 printimage
} bind def

%HELPER: draw single horizontal staff line
/staffline { % xcoord, ycoord, int - 1 means first line, else 0
   4 dict begin
   /first exch def
   /ycoord exch def
   /xcoord exch def
   /width 515 def
   first 1 eq {/width 495 store} {} ifelse
   xcoord ycoord moveto
   0.4 setlinewidth
   width 0 rlineto
   stroke
   end
} bind def

%Bar line
/barline { %xcoord, ycoord, height, linewidth
   4 dict begin
   /linewidth exch def
   /height exch def
   /ycoord exch def
   /ycoord ycoord 0.2 sub store
   /xcoord exch def
   gsave
   linewidth setlinewidth
   xcoord ycoord moveto
   0 height rlineto
   stroke
   grestore
   end
} bind def

%Create the lines
/guitartablines { % x-coord and y-coord of the first measure line bottom left corner, so NOT the extra fancy line, and an int 1 or 0 to say if first line
   5 dict begin
   /flag exch def
   /ycoord exch def
   /xcoord exch def
   gsave
   %first vertical line
   1.33 setlinewidth
   xcoord ycoord 30.4 1.33 barline
   stroke
   % horizontal lines
   0.4 setlinewidth
   0 1 5 {
      /num exch def
      xcoord num 6 mul ycoord add flag staffline
   } for
   1.33 setlinewidth
   /width 515 def
   flag 1 eq {/width 495 store}{} ifelse
   xcoord width add ycoord 30.4 1.33 barline
   stroke
   xcoord ycoord 40 fancyline
   end
} bind def

%create fancy line at the beginning of staff
/fancyline { % given x coord, y coord, height
   3 dict begin
   /height exch def
   /ycoord exch def
   /xcoord exch def
   xcoord 5 sub ycoord 5 sub moveto
   2.5 setlinewidth
   0 height rlineto
   stroke
   newpath %bottom curl
   0.1 setlinewidth
   xcoord 4 sub ycoord 5 sub moveto
   xcoord 2 sub ycoord 5 sub xcoord 0.5 sub ycoord 5.5 sub xcoord 2 add ycoord 8 sub curveto
   xcoord ycoord 4.666 sub xcoord 6 sub ycoord 3 sub 10 arct
   closepath
   fill
   newpath %top curl
   xcoord 4 sub ycoord 5 sub height add moveto
   xcoord 2 sub ycoord 5 sub height add xcoord 0.5 sub ycoord 4.5 sub height add xcoord 2 add ycoord 2 sub height add curveto
   xcoord ycoord 5.333 sub height add xcoord 6 sub ycoord 7 sub height add 10 arct
   closepath
   fill
} bind def

/guitarfretnumber { %xcoord, ycoord, filestring
   8 dict begin
   /str exch def
   /ycoord exch def
   /xcoord exch def
   /scalex 4 def
   /scaley 4.51 def
   /sizex 800 def
   /sizey 902 def
   /filestring (temp) def
   str type /stringtype eq {
      /xcoord xcoord 0.4 sub store
      /filestring (images/Tab_Numbers/) str (.jpg) concatenate concatenate store
      /scalex 4.6 store
      /scaley 4.8 store
      /sizex 1000 store
      }{
      str 9 gt {
         /xcoord xcoord 1.7 sub store
         /scalex 7.3 store
         /sizex 1460 store
         }{} ifelse
      /filestring (images/Tab_Numbers/) str (ffff) cvs (.jpg) concatenate concatenate store
      } ifelse
   xcoord ycoord scalex scaley sizex sizey filestring 1 printimage
   end
} bind def

%%EndProlog

%%print staff
73 652 7 25.2 70 252 (images/Staves/staff.jpg) 3 printimage

%% timesignature
84 656 4 timesignature
84 665 4 timesignature

%%staff lines
70 650 1 guitartablines
50 580 0 guitartablines
50 510 0 guitartablines
50 440 0 guitartablines
50 370 0 guitartablines
50 300 0 guitartablines
50 230 0 guitartablines
50 160 0 guitartablines
50 90 0 guitartablines

100 659.5 5 guitarfretnumber
100 665.5 10 guitarfretnumber
100 671.5 (x) guitarfretnumber

0.9 setlinewidth
102 682 moveto 0 10 rlineto stroke

115 659.5 5 guitarfretnumber
115 665.5 10 guitarfretnumber
115 671.5 (x) guitarfretnumber

130 659.5 3 guitarfretnumber
130 665.5 12 guitarfretnumber

145 653.5 4 guitarfretnumber
145 677.5 19 guitarfretnumber

155 650 30.4 0.7 barline

160 647.5 (x) guitarfretnumber
160 671.5 2 guitarfretnumber






showpage
%%EOF
